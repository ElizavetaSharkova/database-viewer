{"ast":null,"code":"'use strict'; // s2.2.7.13 (introduced in TDS 7.3.B)\n\nvar valueParse = require('../value-parser');\n\nfunction nullHandler(parser, columnMetaData, options, callback) {\n  callback(null);\n}\n\nmodule.exports = function (parser, columnsMetaData, options, callback) {\n  var length = Math.ceil(columnsMetaData.length / 8);\n  parser.readBuffer(length, function (bytes) {\n    var bitmap = [];\n\n    for (var _i = 0, _len = bytes.length; _i < _len; _i++) {\n      var byte = bytes[_i];\n\n      for (var j = 0; j <= 7; j++) {\n        bitmap.push(byte & 1 << j ? true : false);\n      }\n    }\n\n    var columns = options.useColumnNames ? {} : [];\n    var len = columnsMetaData.length;\n    var i = 0;\n\n    function next(done) {\n      if (i === len) {\n        return done();\n      }\n\n      var columnMetaData = columnsMetaData[i];\n      (bitmap[i] ? nullHandler : valueParse)(parser, columnMetaData, options, function (value) {\n        var column = {\n          value: value,\n          metadata: columnMetaData\n        };\n\n        if (options.useColumnNames) {\n          if (columns[columnMetaData.colName] == null) {\n            columns[columnMetaData.colName] = column;\n          }\n        } else {\n          columns.push(column);\n        }\n\n        i++;\n        next(done);\n      });\n    }\n\n    next(function () {\n      callback({\n        name: 'NBCROW',\n        event: 'row',\n        columns: columns\n      });\n    });\n  });\n};","map":null,"metadata":{},"sourceType":"script"}